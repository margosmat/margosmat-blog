---
import { getCollection, render } from 'astro:content';
import Layout from '../../../layouts/Layout.astro';

export async function getStaticPaths() {
  const posts = await getCollection('blog');
  return posts.map(post => ({
    params: { lang: post.data.lang, slug: post.slug },
    props: { post },
  }));
}

const { post } = Astro.props;
const { Content } = await render(post);

const lang = post.data.lang;
const backText = lang === 'en' ? "Back to Blog" : "Powrót do Bloga";
---

<Layout title={`${post.data.title} - Mateusz Margos`} lang={lang}>
  <article class="min-h-screen p-4 md:p-8 flex justify-center">
    <div class="max-w-3xl w-full">
        <div class="mb-8">
             <a href={`/${lang}/blog`} class="text-foreground/60 hover:text-foreground font-medium mb-4 inline-block">&larr; {backText}</a>
             <h1 class="text-4xl md:text-5xl font-bold mb-4 leading-tight">{post.data.title}</h1>
             <div class="flex gap-4 text-foreground/60">
                 <time>{post.data.pubDate.toLocaleDateString(lang, { year: 'numeric', month: 'long', day: 'numeric' })}</time>
                 <span>•</span>
                 <span>{post.data.author}</span>
             </div>
        </div>
        
        <div class="prose prose-lg dark:prose-invert max-w-none prose-headings:font-bold prose-headings:tracking-tight prose-a:text-blue-600 hover:prose-a:text-blue-500 transition-colors">
            <Content />
        </div>
    </div>
  </article>
</Layout>
